---
title: "Exercícios de Testes de Hipóteses para a disciplina de Estatística II"
output:
  html_document:
    df_print: paged
---
O propósito deste trabalho é resolver alguns exercícios de Testes de Hipóteses propostos pela disciplina de Estatística II do curso de graduação em Estatística da Universidade Estatual de Maringá.

Instruções para o uso do R Notebook:

1. Tente executar este pedaço clicando no botão *Run* dentro do pedaço ou colocando o cursor dentro dele e pressionando *Ctrl+Shift+Enter*.

2. Adicione um novo pedaço clicando no botão *Insert Chunk* na barra de ferramentas ou pressionando *Ctrl+Alt+I*.

3. Para instalar um pacote utilize, por exemplo: install.packages("vcd")


#### Bibliotecas usadas
```{r message=FALSE, warning=FALSE}
library(summarytools)
library(vcd)
```
_________________
### Exercício 1
#### TESTE DE HIPOTESES PARA DIFERENÇA DE DUAS MÉDIAS PAREADAS

**EX_21:** Uma empresa de pesquisa de mercado usou uma amostra de indivíduos para avaliar o potencial de compra de determinado produto antes e depois de as pessoas virem um novo comercial de televisão a respeito do produto. As avaliações do potencial de compra basearam-se em uma escala de 0 a 10, e os valores mais altos indicavam maior potencial de compra. A hipótese nula declarava que a avaliação média depois seria igual a avaliação média antes. A rejeição dessa hipótese demonstraria que o comercial melhorou a avaliação do potencial médio de compra. Use  α = 0,05 e os dados apresentados abaixo para testar a hipótese e comentar o valor do comercial.

*Referencia: Anderson, et. al, Estatística Basica, 2010. Exercício 21 - Página. 411*

#### Notas antes e depois do comercial
```{r}
antes   <- c(5, 4, 7, 3, 5, 8, 5, 6)
depois  <- c(6, 6, 7, 4, 3, 9, 7, 6)
```

### Resolução 1. utilizando "t.test"
```{r}
t.test(antes,depois,paired = TRUE)
```

### Resolução 2. Passo a Passo:

#### Cálculos Iniciais
```{r}

diferenca <- depois - antes
diferenca
n <- length(diferenca)
significancia <- 0.05

# grau de liberdade
gl <- n - 1
gl

# Diferença
media_diferenca <- mean(diferenca)
var_dif <- var(diferenca)
desvio_dif <- sd(diferenca)

# Antes
media_antes <- mean(antes)
var_antes <- var(antes)
desvio_antes <- sd(antes)

# Depois
media_depois <- mean(depois)
var_depois <- var(depois)
desvio_depois <- sd(depois)

# Tabela RESUMO
tabela <- data.frame(Referencia = c("Antes","Depois", "diferenca"),
                    Media = c(media_antes,media_depois,media_diferenca),
                    Variancia = c(var_antes,var_depois,var_dif),
                    Desvio = c(desvio_antes,desvio_depois,desvio_dif)
                    )
tabela
```

### Passo 1 - Hipóteses

    * Ho: media_antes = media_depois
    * Ha: media_antes < media_depois

    ou

    * Ho: media_diferenca = 0
    * Ha: media_diferenca > 0

#### Resultados possíveis

    * Ho: As avaliações médias antes e depois do comercial são iguais;
    * Ha: As avaliações antes e depois do comercial são diferentes, sendo maior a media das avaliações após a circulação do comercial.

### Passo 2 - Estatística Teste

```{r}

t_teste <- media_diferenca / (desvio_dif/sqrt(n))
t_teste
```

### Passo 3 - Definir a Região Crítica e p_valor

* Região crítica
```{r}
t_critico <- qt(significancia,df = gl,lower.tail = FALSE)
t_critico


```

* p_valor
```{r}
p_teste <- pt(q = t_teste,df = gl,lower.tail = FALSE)

p_valor <- 1*p_teste
p_valor

```

### Passo 4 - Comparação

i) Como o p_valor > alfa (0,05), não rejeitamos a hipótese Ho;

ii) Como t_teste = 1,357 não pertence a região crítica, não rejeitamos Ho.

### Passo 5 - Conclusão

As médias de avaliação de um determinando produto antes e depois da circulação do comercial são iguais, ao nível de 5% de significancia.

___________________
### Exercício 2
#### TESTE DE HIPOTESES PARA DIFERENÇA DE DUAS MÉDIAS DE POPULAÇÕES NORMAIS COM VARIÂNCIAS DESCONHECIDAS

<img src="exercicio_9_Morettin.png" width="900" height="200">

*Referência: Bussab & Morettin - Página 372 - Exercício 9*

```{r}
liberais  <- c(6.6, 10.3, 10.8, 12.9, 9.2, 12.3, 7.0)
adm  <- c(8.1, 9.8, 8.7, 10.0, 10.2, 8.2, 8.7, 10.1)
```


```{r}
n_liberais <- length(liberais)
n_liberais
n_adm <- length(adm)
n_adm

mediaLiberais <- mean(liberais)
mediaAdm <- mean(adm)

desvio_liberais <- sd(liberais)
desvio_adm <- sd(adm)

var_liberais <- var(liberais)
var_liberais
var_adm <- var(adm)
var_adm

estatisticaTeste <- (mediaLiberais - mediaAdm)/(sqrt(n))

tabela <- data.frame(informacoes=c("amostra","media","desvio_p","variancia"), liberais = c(n_liberais,mediaLiberais,desvio_liberais,var_liberais), adm = c(n_adm, mediaAdm, desvio_adm,var_adm))
tabela

```

## Teste de Variância

    * Ho: variancia a = variancia d
    * Ha: variancia a <> variancia b

#### Resultados possíveis

    * Ho: As variancia são desconhecidas e iguais, portanto homogêneas;
    * Ha: As variancias são desconhecidas e diferentes, portanto não homogêneas.

### Passo 2 - Estatística Teste

```{r}

f_cal <- desvio_liberais/desvio_adm
f_cal

```
### Passo 3 - Definir a Região Crítica

* Região crítica

```{r}
f_critico <- qf(0.975,n_liberais-1,n_adm-1)
f_critico

f0 <- 1/f_critico
f0

```
### Comparação

Como f_cal = 2,74 não pertence a região crítica, não rejeitamos H0.

### Decisão

Como não rejeitamos a hipótese H0 ao nível de 5% de significância, concluímos que as variâncias são desconhecidas e iguais.

Assim, seguimos com o teste de hipóteses para a diferença de médias.

___________
## Teste de Hipóteses
















